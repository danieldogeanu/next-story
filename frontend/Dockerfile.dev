FROM node:18-alpine

ENV NODE_ENV development
ENV NEXT_TELEMETRY_DISABLED 1
ENV STORYBOOK_DISABLE_TELEMETRY 1

ARG LOCAL_ENV
ARG NEXT_PORT
ARG NEXT_PUBLIC_HOSTNAME
ARG NEXT_PUBLIC_BACKEND_URL
ARG NEXT_PUBLIC_FRONTEND_URL
ARG NEXT_PUBLIC_LANG
ARG NEXT_STRAPI_FE_APIKEY
ARG NEXT_STRAPI_BE_APIKEY

ENV LOCAL_ENV=${LOCAL_ENV}
ENV NEXT_PORT=${NEXT_PORT}
ENV NEXT_PUBLIC_HOSTNAME=${NEXT_PUBLIC_HOSTNAME}
ENV NEXT_PUBLIC_BACKEND_URL=${NEXT_PUBLIC_BACKEND_URL}
ENV NEXT_PUBLIC_FRONTEND_URL=${NEXT_PUBLIC_FRONTEND_URL}
ENV NEXT_PUBLIC_LANG=${NEXT_PUBLIC_LANG}
ENV NEXT_STRAPI_FE_APIKEY=${NEXT_STRAPI_FE_APIKEY}
ENV NEXT_STRAPI_BE_APIKEY=${NEXT_STRAPI_BE_APIKEY}

WORKDIR /app
COPY package.json package-lock.json ./
RUN npm ci --include=dev
COPY . .

EXPOSE ${NEXT_PORT}
ENV PORT=${NEXT_PORT}

CMD ["npm", "run", "dev"]
